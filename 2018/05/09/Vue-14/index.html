<!-- build time:Tue Jan 29 2019 23:11:00 GMT+0800 (CST) --><!doctype html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="baidu-site-verification" content="jMvfaeiNGf"><link href="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="https://cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="前端,Vue,"><link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.1.0"><meta name="description" content="作为Vue官方发布的项目脚手架，vue-cli 提供了比较完善的项目构建结构，能够帮助我们快速的完成项目的创建和基本配置。这篇博客主要来介绍vue-cli提供的项目脚手架中，一些配置文件的具体作用，通过对这些配置文件作用的讲解，我们能够清楚的知道项目脚手架的具体构成和实现方式，从而能够更好的解决开发中遇到的一些问题。当然本文会主要涉及webpack方面的脚手架配置，对于vue-router等与vu"><meta name="keywords" content="前端,Vue"><meta property="og:type" content="article"><meta property="og:title" content="Vue系列（十四）：vue-cli的脚手架结构"><meta property="og:url" content="http://yoursite.com/2018/05/09/Vue-14/index.html"><meta property="og:site_name" content="风之处所"><meta property="og:description" content="作为Vue官方发布的项目脚手架，vue-cli 提供了比较完善的项目构建结构，能够帮助我们快速的完成项目的创建和基本配置。这篇博客主要来介绍vue-cli提供的项目脚手架中，一些配置文件的具体作用，通过对这些配置文件作用的讲解，我们能够清楚的知道项目脚手架的具体构成和实现方式，从而能够更好的解决开发中遇到的一些问题。当然本文会主要涉及webpack方面的脚手架配置，对于vue-router等与vu"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2018-05-27T05:37:56.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Vue系列（十四）：vue-cli的脚手架结构"><meta name="twitter:description" content="作为Vue官方发布的项目脚手架，vue-cli 提供了比较完善的项目构建结构，能够帮助我们快速的完成项目的创建和基本配置。这篇博客主要来介绍vue-cli提供的项目脚手架中，一些配置文件的具体作用，通过对这些配置文件作用的讲解，我们能够清楚的知道项目脚手架的具体构成和实现方式，从而能够更好的解决开发中遇到的一些问题。当然本文会主要涉及webpack方面的脚手架配置，对于vue-router等与vu"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{position:"left",display:"post",offset:12,offset_float:0,b2t:!1,scrollpercent:!1},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://yoursite.com/2018/05/09/Vue-14/"><title>Vue系列（十四）：vue-cli的脚手架结构 | 风之处所</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?5a6294a2ef3cbf5009b895119f0909d7";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><a href="https://github.com/Gyufei"><img style="position:absolute;top:0;right:0;border:0" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">风之处所</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description"></h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/09/Vue-14/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Gyf"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="风之处所"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">Vue系列（十四）：vue-cli的脚手架结构</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-09T00:00:00+08:00">2018-05-09 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端/" itemprop="url" rel="index"><span itemprop="name">前端</span> </a></span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/2018/05/09/Vue-14/#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2018/05/09/Vue-14/" itemprop="commentCount"></span></a></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计</span> <span title="字数统计">9,395 字 </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长</span> <span title="阅读时长">41 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>作为<code>Vue</code>官方发布的项目脚手架，<strong><em>vue-cli</em></strong> 提供了比较完善的项目构建结构，能够帮助我们快速的完成项目的创建和基本配置。</p><p>这篇博客主要来介绍<code>vue-cli</code>提供的项目脚手架中，一些配置文件的具体作用，通过对这些配置文件作用的讲解，我们能够清楚的知道项目脚手架的具体构成和实现方式，从而能够更好的解决开发中遇到的一些问题。</p><p>当然本文会主要涉及<code>webpack</code>方面的脚手架配置，对于<code>vue-router</code>等与<code>vue</code>关联比较密切，与项目耦合较深的脚手架配置，因为篇幅有限，不会过多介绍。</p></blockquote><a id="more"></a><p>首先我们先来简单的介绍一下<code>vue-cli</code> 。作为<code>vue</code>项目的常用构建工具，它依赖于<code>node</code>环境，能够提供给我们一个完整的项目配置，提供了本地开发，热加载，测试和打包发布等功能，能够使我们快速的搭建开发环境，进行项目开发。</p><p><code>vue-cli</code> 使用<code>webpack</code>作为项目的构建工具，且已集成<code>webpack</code>，所以我们只需要使用以下命令就可以简单的完成<code>vue-cli</code>的安装。</p><figure class="highlight shell"><figcaption><span>SHELL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g vue-cli</span><br></pre></td></tr></table></figure><p>在安装完成之后，我们就可以使用<code>vue init webpack projectname</code> 来快速的初始化一个<code>vue</code>项目。在项目的初始化搭建过程中，它会询问一些关于你的项目的一些自定义信息，例如项目名称，项目描述等等，很简单，只要一步一步跟着提示做下去，很快就可以完成。</p><h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><p>在项目初始化完成后，进入项目目录下，我们会看到这样一个目录结构：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">├── README.md</span><br><span class="line">├── node_module</span><br><span class="line">├── build</span><br><span class="line">│  ├── check-versions.js</span><br><span class="line">│  ├── build.js</span><br><span class="line">│  ├── utils.js</span><br><span class="line">│  ├── vue-loader.conf.js</span><br><span class="line">│  ├── webpack.base.conf.js</span><br><span class="line">│  ├── webpack.dev.conf.js</span><br><span class="line">│  └── webpack.prod.conf.js</span><br><span class="line">├── config</span><br><span class="line">│  ├── dev.env.js</span><br><span class="line">│  ├── index.js</span><br><span class="line">│  └── prod.env.js</span><br><span class="line">├── index.html</span><br><span class="line">├── package.json</span><br><span class="line">├── src</span><br><span class="line">│  ├── App.vue</span><br><span class="line">│  ├── assets</span><br><span class="line">│  │  └── logo.png</span><br><span class="line">│  ├── components</span><br><span class="line">│  │  └── Hello.vue</span><br><span class="line">│  └── main.js</span><br><span class="line">└── static</span><br></pre></td></tr></table></figure><p>我大概对这些文件做一个简单介绍。</p><p><strong><em>node_module</em></strong>文件夹，我们通过<strong><em>npm</em></strong>安装的项目依赖模块，插件等都存储在此文件夹中。</p><p><strong><em>src</em></strong>文件夹，就是我们进行项目开发的地方，跟项目自身有关的东西基本都在这里面了。它主要包含以下几个部分：</p><ul><li><strong><em>assets</em></strong> 用来放置图片等的文件夹，主要放置例如 <strong><em>logo</em></strong>图片，通用的js和css文件以及字体等等。</li><li><strong><em>components</em></strong> 组件文件夹，用来放置项目中的组件，可以根据项目具体情况来决定是否使用。</li><li><strong><em>App.vue</em></strong> <code>Vue</code>项目的入口文件，作为<code>vue</code>组件树的主入口。</li><li><strong><em>main.js</em></strong> <code>webpack</code>的主入口，是项目编译打包的核心文件，我们在这里初始化Vue实例。</li></ul><p><strong><em>static</em></strong> 文件夹，主要用来存放一些静态资源，也就是我们不想被编译打包的文件，例如某些图片，字体，插件等等。</p><p><strong><em>index.html</em></strong> 项目首页的入口文件，项目经过打包后的模块都会被引入到此文件中。我们可以在这里面添加项目的一些<code>meta</code>信息或统计代码。</p><p><strong><em>package.json</em></strong> 项目的配置文件，包括项目的相关信息，依赖模块信息，脚本命令信息等。</p><p><strong><em>README.md</em></strong> 项目的<code>markdown</code>格式说明文档。</p><p>跟项目的开发环境配置和编译打包配置有关的文件，集中在 <strong><em>build</em></strong> 文件夹和<strong><em>config</em></strong>文件夹下。这两个文件夹，也是我们今天要介绍的主角。</p><p>我会逐个介绍这两个文件夹下每个文件的具体作用，从而让大家明白，它们是通过怎样的配合来完成一个项目的构建和开发环境配置的。</p><h3 id="config文件夹"><a href="#config文件夹" class="headerlink" title="config文件夹"></a><strong><em>config</em></strong>文件夹</h3><p>首先我们来介绍项目的环境配置文件夹。此文件夹下的配置文件主要是用来配置 devServer 和 开发及生产环境下 <strong><em>NODE_ENV</em></strong> 不同时对应的一些配置。</p><p>此文件夹下有三个文件，我们通过注释代码来说明他们的作用。</p><h4 id="index-js"><a href="#index-js" class="headerlink" title="index.js"></a><strong><em>index.js</em></strong></h4><p>根配置文件 <strong><em>index.js</em></strong>，它设置了 <strong><em>dev</em></strong> 和 <strong><em>prod</em></strong> 环境的各自一些配置项，然后导出供其他项目构建文件使用。这个文件里面本来就有比较详细的英文注释，大家可以对照我的注释来加深理解。</p><p>文件内容具体如下：</p><figure class="highlight js"><figcaption><span>index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用js严格模式</span></span><br><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//引入node中常见的path模块，主要用于处理文件和目录路径。</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//开发环境development下的相关配置</span></span><br><span class="line">  dev: &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//路径配置</span></span><br><span class="line">    <span class="comment">//打包后静态文件根目录中的静态资源子目录,用于存放js，css，image，font等项目资源。</span></span><br><span class="line">    <span class="comment">//例如我们打包项目一般会生成dist文件夹来存放打包后文件，我们项目中的静态资源就会位于dist/static文件夹中。</span></span><br><span class="line">    assetsSubDirectory: <span class="string">'static'</span>,</span><br><span class="line">    <span class="comment">// 资源引用目录</span></span><br><span class="line">    assetsPublicPath: <span class="string">'/'</span>,</span><br><span class="line">    <span class="comment">//代理表，主要用于解决项目开发模式时的跨域问题。</span></span><br><span class="line">    <span class="comment">//它使用的是vue-cli自带的http-proxy-middleware插件</span></span><br><span class="line">    proxyTable: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 开发时的本地服务器设置</span></span><br><span class="line">    <span class="comment">//本地服务器IP，可以通过 process.env.HOST 来重写</span></span><br><span class="line">    host: <span class="string">'localhost'</span>,</span><br><span class="line">    <span class="comment">//本地服务器端口，可以通过 process.env.PORT 来重写</span></span><br><span class="line">    port: <span class="number">8080</span>, </span><br><span class="line">    <span class="comment">//是否自动打开浏览器</span></span><br><span class="line">    autoOpenBrowser: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">//是否将错误进行网页全屏覆盖展示</span></span><br><span class="line">    errorOverlay: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">//是否开启更优雅的错误提示</span></span><br><span class="line">    notifyOnErrors: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">//使用文件系统来获取文件改动通知</span></span><br><span class="line">    poll: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//是否使用代码检查插件</span></span><br><span class="line">    useEslint: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">//是否将代码检查检查出的错误也作为全屏错误显示</span></span><br><span class="line">    showEslintErrorsInOverlay: <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//map文件的生成模式，</span></span><br><span class="line">    devtool: <span class="string">'cheap-module-eval-source-map'</span>,</span><br><span class="line">    <span class="comment">//是否在开发时进行文件缓存失效处理</span></span><br><span class="line">    cacheBusting: <span class="literal">true</span>,</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//是否生成css的map文件，map文件主要用于对应文件压缩前后的位置，便于调试</span></span><br><span class="line">    cssSourceMap: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  build: &#123;</span><br><span class="line">    <span class="comment">// 模板文件 index.html 路径。path.resolve用于拼接路径，__dirname为当前目录路径</span></span><br><span class="line">    index: path.resolve(__dirname, <span class="string">'../dist/index.html'</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打包后的静态文件的根目录，一般为dist</span></span><br><span class="line">    assetsRoot: path.resolve(__dirname, <span class="string">'../dist'</span>),</span><br><span class="line">    <span class="comment">// 打包后静态文件中静态资源子目录</span></span><br><span class="line">    assetsSubDirectory: <span class="string">'static'</span>,</span><br><span class="line">    <span class="comment">// 静态资源的引用路径</span></span><br><span class="line">    assetsPublicPath: <span class="string">'/'</span>,</span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">    <span class="comment">// 是否生成map文件</span></span><br><span class="line">    productionSourceMap: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// map文件生成模式</span></span><br><span class="line">    devtool: <span class="string">'#source-map'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 是否压缩文件</span></span><br><span class="line">    <span class="comment">// 如果要压缩，需要先命令行执行 npm install --save-dev compression-webpack-plugin</span></span><br><span class="line">    productionGzip: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// 要压缩的文件类型</span></span><br><span class="line">    productionGzipExtensions: [<span class="string">'js'</span>, <span class="string">'css'</span>],</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 是否开启编译完成后的报告，可设为true和false。默认为环境里的 npm_config_report 变量值</span></span><br><span class="line">    <span class="comment">// 设为ture时，可以通过 npm run build --report 来开启报告模式</span></span><br><span class="line">    bundleAnalyzerReport: process.env.npm_config_report</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上面我们提到<code>proxyTable</code>配置项，它借助<code>http-proxy-middleware</code>插件，来建立一个虚拟api服务器，从而解决我们在开发模式下遇到的跨域问题。用法一般如下：</p><figure class="highlight js"><figcaption><span>proxyTable</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">proxyTable: &#123;</span><br><span class="line">     <span class="comment">//当请求这个地址时进行代理从而避开跨域</span></span><br><span class="line">    <span class="string">'/users'</span>:&#123;</span><br><span class="line">        target: <span class="string">'http://api.someurl.com'</span>   <span class="comment">//要跨域请求的网站</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,                <span class="comment">//是否跨域</span></span><br><span class="line">        secure: <span class="literal">false</span>,  <span class="comment">// 如果是https接口，需要配置为true</span></span><br><span class="line">        pathRewrites：&#123;</span><br><span class="line">            <span class="comment">//在请求目标路径时将代理路径重写，例如此时请求'/users'，请求的真实接口为http://api.someurl.com/re</span></span><br><span class="line">            <span class="string">'^/users'</span>: <span class="string">'/re'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="prod-env-js"><a href="#prod-env-js" class="headerlink" title="prod.env.js"></a><strong><em>prod.env.js</em></strong></h4><p><strong><em>production</em></strong> 环境的配置文件 <strong><em>prod.env.js</em></strong>，因为在 <strong><em>index.js</em></strong>中已经包含了大部分配置项，所以此文件的配置项非常简单，只是导出一个对象，<code>NODE_ENV</code> 为环境变量，指定 <strong><em>production</em></strong> 环境。</p><figure class="highlight js"><figcaption><span>prod.env.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  NODE_ENV: <span class="string">'"production"'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="dev-env-js"><a href="#dev-env-js" class="headerlink" title="dev.env.js"></a><strong><em>dev.env.js</em></strong></h4><p><strong><em>development</em></strong> 环境的配置 <strong><em>dev.env.js</em></strong> ,它合并了 <strong><em>production</em></strong> 的配置对象(覆盖相同配置项)。</p><figure class="highlight js"><figcaption><span>dev.env.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用严格模式</span></span><br><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="comment">//引入webpack的merge插件，此插件用于对象的合并，会覆盖相同选项。主要用于配置文件的合并</span></span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="comment">//引入prod.env.js配置文件</span></span><br><span class="line"><span class="keyword">const</span> prodEnv = <span class="built_in">require</span>(<span class="string">'./prod.env'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//合并prod配置，并导出一个对象，其中 NODE_ENV 环境变量为 development</span></span><br><span class="line"><span class="built_in">module</span>.exports = merge(prodEnv, &#123;</span><br><span class="line">  NODE_ENV: <span class="string">'"development"'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="build-文件夹"><a href="#build-文件夹" class="headerlink" title="build 文件夹"></a><strong><em>build 文件夹</em></strong></h3><p><strong><em>build</em></strong> 文件夹下是项目构建中<code>webpack</code>相关配置文件的目录。</p><p>主要有以下几个文件</p><ul><li><strong><em>check-versions.js</em></strong> 主要用来检查<strong><em>node</em></strong>和<strong><em>npm</em></strong>版本</li><li><strong><em>utils.js</em></strong> 工具库文件，主要定义了配置文件中几个公用的函数</li><li><strong><em>webpack.base.conf.js</em></strong> <code>webpack</code>的基本配置</li><li><strong><em>webpack.prod.conf.js</em></strong> <code>webpack</code>在<strong><em>prod</em></strong> 模式下的配置文件</li><li><strong><em>webpack.dev.conf.js</em></strong> <code>webpack</code> 在 <strong><em>dev</em></strong> 模式下的配置文件</li><li><strong><em>vue-loader.conf.js</em></strong> <code>webpack</code>中关于 <code>.vue</code> 文件中<code>css</code>构建解析的配置</li><li><strong><em>build.js</em></strong> 项目构建入口，即<code>npm run build</code>的入口文件</li></ul><h4 id="webpack-base-conf-js"><a href="#webpack-base-conf-js" class="headerlink" title="webpack.base.conf.js"></a><strong><em>webpack.base.conf.js</em></strong></h4><p>我们首先来看 <code>webpack</code>的基础配置文件 <strong><em>webpack.base.conf.js</em></strong></p><figure class="highlight js"><figcaption><span>webpack.base.conf.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用严格模式</span></span><br><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="comment">// 导入目录和路径模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">// 导入工具函数文件</span></span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'./utils'</span>)</span><br><span class="line"><span class="comment">// 导入环境配置文件，即 config 文件夹下的 index.js 文件。</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">'../config'</span>)</span><br><span class="line"><span class="comment">// 导入 vue-loader.conf 中关于 .vue 文件的 webpack配置</span></span><br><span class="line"><span class="keyword">const</span> vueLoaderConfig = <span class="built_in">require</span>(<span class="string">'./vue-loader.conf'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 此函数是用来返回当前目录的平行目录的路径</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span> (<span class="params">dir</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> path.join(__dirname, <span class="string">'..'</span>, dir)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成有关格式检查 eslint 的一些配置</span></span><br><span class="line"><span class="keyword">const</span> createLintingRule = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;</span><br><span class="line">  <span class="comment">//使用格式检查的文件类型</span></span><br><span class="line">  test: <span class="regexp">/\.(js|vue)$/</span>,</span><br><span class="line">  <span class="comment">//格式检查使用的loader</span></span><br><span class="line">  loader: <span class="string">'eslint-loader'</span>,</span><br><span class="line">  <span class="comment">//是否在编译前检测</span></span><br><span class="line">  enforce: <span class="string">'pre'</span>,</span><br><span class="line">  <span class="comment">// 要检查的目录，还可以通过 exclude 选项排除文件夹</span></span><br><span class="line">  include: [resolve(<span class="string">'src'</span>), resolve(<span class="string">'test'</span>)],</span><br><span class="line">  <span class="comment">// 传递给eslint-loader的参数</span></span><br><span class="line">  options: &#123;</span><br><span class="line">    <span class="comment">//更友好的错误信息</span></span><br><span class="line">    formatter: <span class="built_in">require</span>(<span class="string">'eslint-friendly-formatter'</span>),</span><br><span class="line">    <span class="comment">//错误是否全屏显示在网页浮层上，使用config中index.js定义的配置值</span></span><br><span class="line">    emitWarning: !config.dev.showEslintErrorsInOverlay</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//webpack发挥作用的基础目录，一般默认为当前目录</span></span><br><span class="line">  context: path.resolve(__dirname, <span class="string">'../'</span>),</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// webpack 应用程序的起点入口</span></span><br><span class="line">  entry: &#123;</span><br><span class="line">    app: <span class="string">'./src/main.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// webpack打包的出口目录</span></span><br><span class="line">  output: &#123;</span><br><span class="line">    <span class="comment">// 打包后文件的保存路径，在config文件夹中配置</span></span><br><span class="line">    path: config.build.assetsRoot,</span><br><span class="line">    <span class="comment">// 打包后的文件名</span></span><br><span class="line">    filename: <span class="string">'[name].js'</span>,</span><br><span class="line">    <span class="comment">// 文件的真实引用路径，根据config中的配置确定</span></span><br><span class="line">    publicPath: process.env.NODE_ENV === <span class="string">'production'</span></span><br><span class="line">      ? config.build.assetsPublicPath</span><br><span class="line">      : config.dev.assetsPublicPath</span><br><span class="line">  &#125;,</span><br><span class="line">    </span><br><span class="line">  <span class="comment">//webpack 模块解析的相关配置</span></span><br><span class="line">  resolve: &#123;</span><br><span class="line">    <span class="comment">// 如果引入文件以以下选项结尾，则进行解析，否则直接打包</span></span><br><span class="line">    extensions: [<span class="string">'.js'</span>, <span class="string">'.vue'</span>, <span class="string">'.json'</span>],</span><br><span class="line">    <span class="comment">// webpack引入模块或文件时路径中可使用的别名</span></span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="comment">// 后面的$符号指精确匹配，</span></span><br><span class="line">      <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.esm.js'</span>,</span><br><span class="line">      <span class="string">'@'</span>: resolve(<span class="string">'src'</span>),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// webpack 对项目模块化的配置</span></span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">        </span><br><span class="line">      <span class="comment">// 如果在 config 中开启了格式检查eslint，就使用上面定义的函数生成有关eslint的webpack配置。</span></span><br><span class="line">      ...(config.dev.useEslint ? [createLintingRule()] : []),</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 对vue文件使用导入的 vue-loader.conf.js 中的配置，主要用于处理各种形式的css</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">        <span class="comment">// vue-loader 是 vue单文件组件的实现核心，专门用于解析.vue文件</span></span><br><span class="line">        loader: <span class="string">'vue-loader'</span>,</span><br><span class="line">        options: vueLoaderConfig</span><br><span class="line">      &#125;,</span><br><span class="line">        </span><br><span class="line">      <span class="comment">// js文件的webpack配置</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        <span class="comment">// 对js文件使用babel-loader解码，主要用来解析ES6语法等。</span></span><br><span class="line">        loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">        include: [resolve(<span class="string">'src'</span>), resolve(<span class="string">'test'</span>), resolve(<span class="string">'node_modules/webpack-dev-server/client'</span>)]</span><br><span class="line">      &#125;,</span><br><span class="line">        </span><br><span class="line">      <span class="comment">//图片相关文件的webpack配置</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif|svg)(\?.*)?$/</span>,</span><br><span class="line">        <span class="comment">// 对图片相关的文件使用url-loader插件，在图片尺寸较小时，将其解析为base64的DataURL形式</span></span><br><span class="line">        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          <span class="comment">// 限制10000字节以下的图片转换为 DataURLURL形式</span></span><br><span class="line">          limit: <span class="number">10000</span>,</span><br><span class="line">          <span class="comment">//转换后的图片文件名</span></span><br><span class="line">          name: utils.assetsPath(<span class="string">'img/[name].[hash:7].[ext]'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">        </span><br><span class="line">      <span class="comment">//音频和视频文件的webpack配置，与图片配置类似</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(mp4|webm|ogg|mp3|wav|flac|aac)(\?.*)?$/</span>,</span><br><span class="line">        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">10000</span>,</span><br><span class="line">          name: utils.assetsPath(<span class="string">'media/[name].[hash:7].[ext]'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">        </span><br><span class="line">      <span class="comment">//字体文件的webpack配置，与图片类似</span></span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(woff2?|eot|ttf|otf)(\?.*)?$/</span>,</span><br><span class="line">        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">10000</span>,</span><br><span class="line">          name: utils.assetsPath(<span class="string">'fonts/[name].[hash:7].[ext]'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">    </span><br><span class="line">  <span class="comment">//自定义NODEJS环境</span></span><br><span class="line">  node: &#123;</span><br><span class="line">    <span class="comment">//阻止webpack引入一些Vue已内置或开发环境中不需要的node模块和功能</span></span><br><span class="line">    setImmediate: <span class="literal">false</span>,</span><br><span class="line">    dgram: <span class="string">'empty'</span>,</span><br><span class="line">    fs: <span class="string">'empty'</span>,</span><br><span class="line">    net: <span class="string">'empty'</span>,</span><br><span class="line">    tls: <span class="string">'empty'</span>,</span><br><span class="line">    child_process: <span class="string">'empty'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上是<code>webpack</code>基本的配置，也就是不管在开发环境还是生产环境下通用的一些配置。对于特定生产环境下的特定配置，集中在 <strong><em>webpack.dev.conf.js</em></strong> 和 <strong>webpack.prod.conf.js</strong> 下。</p><p>在开发环境中，我们需要项目具有本地服务器，实时加载和热替换模块等能力。而在生产模式中，我们则需要更小的打包后尺寸，更轻量的项目体积。因此我们一般会将各自环境下所需的<code>webpack</code>配置都放在单独的文件中。</p><h4 id="webpack-prod-conf-js"><a href="#webpack-prod-conf-js" class="headerlink" title="webpack.prod.conf.js"></a><strong><em>webpack.prod.conf.js</em></strong></h4><p><strong><em>webpack.prod.conf.js</em></strong> 文件是生产环境下<code>webpack</code>的核心配置文件。</p><figure class="highlight js"><figcaption><span>webpack.prod.conf.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用js严格模式</span></span><br><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="comment">//引入nodejs目录路径模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">//引入 utils.js 工具配置文件，具体可查看本文下面对其的详细介绍</span></span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'./utils'</span>)</span><br><span class="line"><span class="comment">//引入webpack，从而使用webpack的内置的一些插件</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="comment">//引入 config 文件夹下的 index.js 配置文件。具体查看本文上面对其的具体介绍。</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">'../config'</span>)</span><br><span class="line"><span class="comment">//引入webpack的merage插件，来处理配置对象的合并。相同项将会被覆盖。</span></span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="comment">//引入基础的webpack配置文件，具体看上面对其的介绍</span></span><br><span class="line"><span class="keyword">const</span> baseWebpackConfig = <span class="built_in">require</span>(<span class="string">'./webpack.base.conf'</span>)</span><br><span class="line"><span class="comment">//引入webpack的copy插件，主要用于复制文件或文件夹到指定目录</span></span><br><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>)</span><br><span class="line"><span class="comment">//引入webpack的html插件，用于设置模板index.html，自动将打包后资源引入到html文件中。</span></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="comment">//引入webpack的extractText插件，用于将文本从bundle中提取到一个单独的文件中。主要用于处理css。</span></span><br><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>)</span><br><span class="line"><span class="comment">//引入webpack的optimizeCSS插件，用来压缩css代码，同时去除重复代码，与上个插件配合使用来处理css模块</span></span><br><span class="line"><span class="keyword">const</span> OptimizeCSSPlugin = <span class="built_in">require</span>(<span class="string">'optimize-css-assets-webpack-plugin'</span>)</span><br><span class="line"><span class="comment">//引入uglifyjs插件，对js进行压缩处理</span></span><br><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//引入环境配置中的prod.env.js环境配置</span></span><br><span class="line"><span class="keyword">const</span> env = <span class="built_in">require</span>(<span class="string">'../config/prod.env'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//将prod的webpack配置对象和基础的webpack配置对象合并</span></span><br><span class="line"><span class="keyword">const</span> webpackConfig = merge(baseWebpackConfig, &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    <span class="comment">// 使用utils.js中的方法，生成各种css类型的配置。</span></span><br><span class="line">    rules: utils.styleLoaders(&#123;</span><br><span class="line">      sourceMap: config.build.productionSourceMap,</span><br><span class="line">      <span class="comment">//是否生成独立文件</span></span><br><span class="line">      extract: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">//项目是否使用postCSS</span></span><br><span class="line">      usePostCSS: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">    </span><br><span class="line">  <span class="comment">//根据config中的配置确定是否生成便于调试的sourcemap文件</span></span><br><span class="line">  devtool: config.build.productionSourceMap ? config.build.devtool : <span class="literal">false</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    <span class="comment">// config中的打包后文件路径配置</span></span><br><span class="line">    path: config.build.assetsRoot,</span><br><span class="line">    <span class="comment">// 打包后的文件名，name为文件名，chunkhash是模块的hash值，用于浏览器缓存。</span></span><br><span class="line">    filename: utils.assetsPath(<span class="string">'js/[name].[chunkhash].js'</span>),</span><br><span class="line">    <span class="comment">//非入口的chunk文件名，</span></span><br><span class="line">    chunkFilename: utils.assetsPath(<span class="string">'js/[id].[chunkhash].js'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// 利用webpack的DefinePlugin插件，定义process.env环境变量为env。</span></span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="string">'process.env'</span>: env</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// 使用 UglifyJSplugin来压缩js文件。</span></span><br><span class="line">    <span class="keyword">new</span> UglifyJsPlugin(&#123;</span><br><span class="line">      uglifyOptions: &#123;</span><br><span class="line">        compress: &#123;</span><br><span class="line">          <span class="comment">//禁止压缩时的警告信息</span></span><br><span class="line">          warnings: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">//根据config中的文件配置来确定是否生成map文件。</span></span><br><span class="line">      sourceMap: config.build.productionSourceMap,</span><br><span class="line">      <span class="comment">//是否启用多线程压缩，速度更快。</span></span><br><span class="line">      parallel: <span class="literal">true</span></span><br><span class="line">    &#125;),</span><br><span class="line">      </span><br><span class="line">    <span class="comment">//使用ExtractTextPlugin来将css抽离为单独的文件。</span></span><br><span class="line">    <span class="keyword">new</span> ExtractTextPlugin(&#123;</span><br><span class="line">      <span class="comment">//抽离后css单独的文件名</span></span><br><span class="line">      filename: utils.assetsPath(<span class="string">'css/[name].[contenthash].css'</span>),</span><br><span class="line">      allChunks: <span class="literal">true</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// 使用OptimizeCSSPlugin来将去除重复的css并压缩css</span></span><br><span class="line">    <span class="keyword">new</span> OptimizeCSSPlugin(&#123;</span><br><span class="line">      <span class="comment">//传入config中的设置来确定是否生成map文件</span></span><br><span class="line">      cssProcessorOptions: config.build.productionSourceMap</span><br><span class="line">        ? &#123; <span class="attr">safe</span>: <span class="literal">true</span>, <span class="attr">map</span>: &#123; <span class="attr">inline</span>: <span class="literal">false</span> &#125; &#125;</span><br><span class="line">        : &#123; <span class="attr">safe</span>: <span class="literal">true</span> &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//生成用于打包后文件挂载的html页面</span></span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      <span class="comment">//根据config中的配置来确定html页面名</span></span><br><span class="line">      filename: config.build.index,</span><br><span class="line">      <span class="comment">//生成html页面使用的模板文件</span></span><br><span class="line">      template: <span class="string">'index.html'</span>,</span><br><span class="line">      <span class="comment">//将js文件的引入放到html的body标签后面</span></span><br><span class="line">      inject: <span class="literal">true</span>,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        <span class="comment">//移除注释</span></span><br><span class="line">        removeComments: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">//压缩空格</span></span><br><span class="line">        collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">//去除属性的引用</span></span><br><span class="line">        removeAttributeQuotes: <span class="literal">true</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">//在存在chunk时chunk的排序模式</span></span><br><span class="line">      chunksSortMode: <span class="string">'dependency'</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">//在文件未改变时保证文件id不变从而缓存文件</span></span><br><span class="line">    <span class="keyword">new</span> webpack.HashedModuleIdsPlugin(),</span><br><span class="line">    <span class="comment">// 在js文件中进行作用域提升，从而让代码文件更小，一般使用于ES6</span></span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.ModuleConcatenationPlugin(),</span><br><span class="line">    <span class="comment">// 将打包后的文件中的第三方库文件抽取出来，便于浏览器缓存，提高运行速度。</span></span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      <span class="comment">// 将第三方库文件（主要是node_modules中的库)打包到vendor中</span></span><br><span class="line">      name: <span class="string">'vendor'</span>,</span><br><span class="line">      minChunks (<span class="built_in">module</span>) &#123;</span><br><span class="line">        <span class="comment">// any required modules inside node_modules are extracted to vendor</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="built_in">module</span>.resource &amp;&amp;</span><br><span class="line">          /\.js$/.test(<span class="built_in">module</span>.resource) &amp;&amp;</span><br><span class="line">          <span class="built_in">module</span>.resource.indexOf(</span><br><span class="line">            path.join(__dirname, <span class="string">'../node_modules'</span>)</span><br><span class="line">          ) === <span class="number">0</span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 将webpack的runtime时的代码和模块提取到mainfest文件中，防止在代码被修改但未修改第三方库文件时第三方库仍然打包。 </span></span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="string">'manifest'</span>,</span><br><span class="line">      minChunks: <span class="literal">Infinity</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="string">'app'</span>,</span><br><span class="line">      <span class="keyword">async</span>: <span class="string">'vendor-async'</span>,</span><br><span class="line">      children: <span class="literal">true</span>,</span><br><span class="line">      minChunks: <span class="number">3</span></span><br><span class="line">    &#125;),</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用复制文件的插件来过滤掉打包过程中产生的以.开头的文件</span></span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">from</span>: path.resolve(__dirname, <span class="string">'../static'</span>),</span><br><span class="line">        to: config.build.assetsSubDirectory,</span><br><span class="line">        ignore: [<span class="string">'.*'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ])</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果在config文件中打开了代码压缩配置，会在下面进行代码压缩。</span></span><br><span class="line"><span class="keyword">if</span> (config.build.productionGzip) &#123;</span><br><span class="line">  <span class="keyword">const</span> CompressionWebpackPlugin = <span class="built_in">require</span>(<span class="string">'compression-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line">  webpackConfig.plugins.push(</span><br><span class="line">    <span class="keyword">new</span> CompressionWebpackPlugin(&#123;</span><br><span class="line">      <span class="comment">//打包后的文件名</span></span><br><span class="line">      asset: <span class="string">'[path].gz[query]'</span>,</span><br><span class="line">      algorithm: <span class="string">'gzip'</span>,</span><br><span class="line">      <span class="comment">//压缩config文件中规定的压缩文件</span></span><br><span class="line">      test: <span class="keyword">new</span> <span class="built_in">RegExp</span>(</span><br><span class="line">        <span class="string">'\\.('</span> +</span><br><span class="line">        config.build.productionGzipExtensions.join(<span class="string">'|'</span>) +</span><br><span class="line">        <span class="string">')$'</span></span><br><span class="line">      ),</span><br><span class="line">      <span class="comment">//小于此大小的文件不会被压缩</span></span><br><span class="line">      threshold: <span class="number">10240</span>,</span><br><span class="line">      <span class="comment">//压缩率小于此值的文件才会被压缩</span></span><br><span class="line">      minRatio: <span class="number">0.8</span></span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//列出打包后文件的详细文件信息，vue-cli默认禁用了，个人感觉也的确没什么用。</span></span><br><span class="line"><span class="keyword">if</span> (config.build.bundleAnalyzerReport) &#123;</span><br><span class="line">  <span class="keyword">const</span> BundleAnalyzerPlugin = <span class="built_in">require</span>(<span class="string">'webpack-bundle-analyzer'</span>).BundleAnalyzerPlugin</span><br><span class="line">  webpackConfig.plugins.push(<span class="keyword">new</span> BundleAnalyzerPlugin())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将合并后的配置对象导出</span></span><br><span class="line"><span class="built_in">module</span>.exports = webpackConfig</span><br></pre></td></tr></table></figure><h4 id="webpack-dev-conf-js"><a href="#webpack-dev-conf-js" class="headerlink" title="webpack.dev.conf.js"></a><strong><em>webpack.dev.conf.js</em></strong></h4><p><strong><em>webpack.dev.conf.js</em></strong> 中是在开发模式下的一些<code>webpack</code>配置。当我们执行<code>npm run dev</code>时，执行的就是此文件。</p><figure class="highlight js"><figcaption><span>webpack.dev.conf.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用js严格模式</span></span><br><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="comment">//引入utils.js中定义好的函数，此文件会在下面详细解释</span></span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'./utils'</span>)</span><br><span class="line"><span class="comment">//引入webpack，需要使用它的一些自带插件</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="comment">//引入config文件夹中的配置</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">'../config'</span>)</span><br><span class="line"><span class="comment">//引入webpack-merge插件，主要用于合并配置对象</span></span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="comment">//引入路径模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">//引入webpack.base.conf中基础的webpack配置</span></span><br><span class="line"><span class="keyword">const</span> baseWebpackConfig = <span class="built_in">require</span>(<span class="string">'./webpack.base.conf'</span>)</span><br><span class="line"><span class="comment">//引入webpack的copy插件，主要用于复制文件或文件夹到指定目录</span></span><br><span class="line"><span class="keyword">const</span> CopyWebpackPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>)</span><br><span class="line"><span class="comment">//引入webpack的html插件，用于设置模板index.html，自动将打包后资源引入到html文件中。</span></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="comment">//引入FriendError插件，对错误进行收集汇总，并以更友好的形式输出。</span></span><br><span class="line"><span class="keyword">const</span> FriendlyErrorsPlugin = <span class="built_in">require</span>(<span class="string">'friendly-errors-webpack-plugin'</span>)</span><br><span class="line"><span class="comment">//搜索闲置端口，默认情况下是8000</span></span><br><span class="line"><span class="keyword">const</span> portfinder = <span class="built_in">require</span>(<span class="string">'portfinder'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//当前程序环境的地址</span></span><br><span class="line"><span class="keyword">const</span> HOST = process.env.HOST</span><br><span class="line"><span class="comment">//当前程序环境下的端口</span></span><br><span class="line"><span class="keyword">const</span> PORT = process.env.PORT &amp;&amp; <span class="built_in">Number</span>(process.env.PORT)</span><br><span class="line"></span><br><span class="line"><span class="comment">//将dev的webpack配置对象和基础的webpack配置对象合并</span></span><br><span class="line"><span class="keyword">const</span> devWebpackConfig = merge(baseWebpackConfig, &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">     <span class="comment">// 使用utils.js中的方法，生成各种css类型的转换和格式化配置。</span></span><br><span class="line">    rules: utils.styleLoaders(&#123; <span class="attr">sourceMap</span>: config.dev.cssSourceMap, <span class="attr">usePostCSS</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 根据config中的配置确定是否生成便于调试的sourcemap文件</span></span><br><span class="line">  devtool: config.dev.devtool,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 本地开发服务器配置</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    <span class="comment">//在浏览器控制台显示消息的级别限制</span></span><br><span class="line">    clientLogLevel: <span class="string">'warning'</span>,</span><br><span class="line">    <span class="comment">//使用HTML5 histort API</span></span><br><span class="line">    historyApiFallback: &#123;</span><br><span class="line">      <span class="comment">//将404页面导向到index.html，对于SPA单页面应用非常有用。</span></span><br><span class="line">      rewrites: [</span><br><span class="line">        &#123; <span class="attr">from</span>: <span class="regexp">/.*/</span>, <span class="attr">to</span>: path.posix.join(config.dev.assetsPublicPath, <span class="string">'index.html'</span>) &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//启用模块热更新</span></span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">//dev-server的默认根目录为当前目录</span></span><br><span class="line">    contentBase: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">//使用gzip方式压缩代码</span></span><br><span class="line">    compress: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">//dev-server的host，如果未在config中设置则使用默认设置localhost</span></span><br><span class="line">    host: HOST || config.dev.host,</span><br><span class="line">    <span class="comment">//dev-server的port，如果未在config中设置则使用8000端口</span></span><br><span class="line">    port: PORT || config.dev.port,</span><br><span class="line">    <span class="comment">//根据config中的配置来确定是否自动打开浏览器</span></span><br><span class="line">    open: config.dev.autoOpenBrowser,</span><br><span class="line">    <span class="comment">//根据config中配置来确定是否错误全屏覆盖页面显示</span></span><br><span class="line">    overlay: config.dev.errorOverlay</span><br><span class="line">      ? &#123; <span class="attr">warnings</span>: <span class="literal">false</span>, <span class="attr">errors</span>: <span class="literal">true</span> &#125;</span><br><span class="line">      : <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">//dev-sever的根目录，默认是'/'，如果项目并不是在网站根目录下，可以通过config中设置修改</span></span><br><span class="line">    publicPath: config.dev.assetsPublicPath,</span><br><span class="line">    <span class="comment">//根据config中的proxyTable来确定是否启用代理</span></span><br><span class="line">    proxy: config.dev.proxyTable,</span><br><span class="line">    <span class="comment">//不向控制台打印webpack相关的错误</span></span><br><span class="line">    quiet: <span class="literal">true</span>, </span><br><span class="line">    <span class="comment">//侦听文件改变选项</span></span><br><span class="line">    watchOptions: &#123;</span><br><span class="line">      <span class="comment">//根据config文件中侦听选项来进行文件侦听，在config中我们设置的是使用文件系统来获取文件改变</span></span><br><span class="line">      poll: config.dev.poll,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">    </span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">//使用此webpack插件定义全局环境常量</span></span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="string">'process.env'</span>: <span class="built_in">require</span>(<span class="string">'../config/dev.env'</span>)</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">//使用此webpack插件进行文件改变自动刷新，模块热更新，绝对不能在生产环境下使用！</span></span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(),</span><br><span class="line">    <span class="comment">//使用此webpack插件在模块更新时在控制台打印出文件名</span></span><br><span class="line">    <span class="keyword">new</span> webpack.NamedModulesPlugin(), </span><br><span class="line">    <span class="comment">//使用此webpack插件跳过编译错误并记录错误代码</span></span><br><span class="line">    <span class="keyword">new</span> webpack.NoEmitOnErrorsPlugin(),</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//使用此插件生成挂载打包后资源的html文件</span></span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: <span class="string">'index.html'</span>,</span><br><span class="line">      <span class="comment">//生成html页面使用的模板文件</span></span><br><span class="line">      template: <span class="string">'index.html'</span>,</span><br><span class="line">      <span class="comment">//将js文件的引入放到html的body标签后面</span></span><br><span class="line">      inject: <span class="literal">true</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// 使用复制文件的插件来过滤掉打包过程中产生的以.开头的文件</span></span><br><span class="line">    <span class="keyword">new</span> CopyWebpackPlugin([</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">from</span>: path.resolve(__dirname, <span class="string">'../static'</span>),</span><br><span class="line">        to: config.dev.assetsSubDirectory,</span><br><span class="line">        ignore: [<span class="string">'.*'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ])</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//将webpack配置对象异步传递出去（因为要进行寻找端口号等耗时操作</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  portfinder.basePort = process.env.PORT || config.dev.port</span><br><span class="line">  <span class="comment">//查找当前环境端口</span></span><br><span class="line">  portfinder.getPort(<span class="function">(<span class="params">err, port</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      reject(err)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      process.env.PORT = port</span><br><span class="line">      <span class="comment">//如果端口未被占用就将当前进程绑定到端口</span></span><br><span class="line">      devWebpackConfig.devServer.port = port</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 添加文件顶部引入的错误信息整理美化插件</span></span><br><span class="line">      devWebpackConfig.plugins.push(<span class="keyword">new</span> FriendlyErrorsPlugin(&#123;</span><br><span class="line">        compilationSuccessInfo: &#123;</span><br><span class="line">          messages: [<span class="string">`Your application is running here: http://<span class="subst">$&#123;devWebpackConfig.devServer.host&#125;</span>:<span class="subst">$&#123;port&#125;</span>`</span>],</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//添加错误发生所在域名和端口的提示信息</span></span><br><span class="line">        onErrors: config.dev.notifyOnErrors</span><br><span class="line">        ? utils.createNotifierCallback()</span><br><span class="line">        : <span class="literal">undefined</span></span><br><span class="line">      &#125;))</span><br><span class="line">      <span class="comment">//将配置好的webpack配置传递出去</span></span><br><span class="line">      resolve(devWebpackConfig)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="vue-loader-conf-js"><a href="#vue-loader-conf-js" class="headerlink" title="vue-loader.conf.js"></a><strong><em>vue-loader.conf.js</em></strong></h4><p>此文件是<code>vue-cli</code> 中用于生成处理<code>.vue</code>单文件<code>webpack</code>配置。主要是用于解决<code>vue</code>中各种格式，如<code>css</code>，<code>scss</code>，<code>less</code>等的转换处理。</p><figure class="highlight js"><figcaption><span>vue-loader.conf.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用js严格模式</span></span><br><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="comment">//引入utils.js中的相关方法</span></span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'./utils'</span>)</span><br><span class="line"><span class="comment">//引入config中的相关配置</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">'../config'</span>)</span><br><span class="line"><span class="comment">//判断是否为生产环境</span></span><br><span class="line"><span class="keyword">const</span> isProduction = process.env.NODE_ENV === <span class="string">'production'</span></span><br><span class="line"><span class="comment">//根据生产环境来确定ma文件的生成模式</span></span><br><span class="line"><span class="keyword">const</span> sourceMapEnabled = isProduction</span><br><span class="line">  ? config.build.productionSourceMap</span><br><span class="line">  : config.dev.cssSourceMap</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//使用utils.js中提供的方法生成css相关的loader配置</span></span><br><span class="line">  loaders: utils.cssLoaders(&#123;</span><br><span class="line">    sourceMap: sourceMapEnabled,</span><br><span class="line">    <span class="comment">//是否将样式提取到单独的文件</span></span><br><span class="line">    extract: isProduction</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="comment">//是否生成css的map文件</span></span><br><span class="line">  cssSourceMap: sourceMapEnabled,</span><br><span class="line">  <span class="comment">//是否禁用文件缓存</span></span><br><span class="line">  cacheBusting: config.dev.cacheBusting,</span><br><span class="line">  <span class="comment">//在模板编译时，将某些资源引用，如src等，转换为require形式调用</span></span><br><span class="line">  transformToRequire: &#123;</span><br><span class="line">    video: [<span class="string">'src'</span>, <span class="string">'poster'</span>],</span><br><span class="line">    source: <span class="string">'src'</span>,</span><br><span class="line">    img: <span class="string">'src'</span>,</span><br><span class="line">    image: <span class="string">'xlink:href'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="utils-js"><a href="#utils-js" class="headerlink" title="utils.js"></a><strong><em>utils.js</em></strong></h4><p><strong><em>utils.js</em></strong>文件主要存放了几个方法函数，例如生成<code>vue-loader.conf.js</code>需要的<code>css</code>的一些<code>loader</code>配置的方法等。</p><figure class="highlight js"><figcaption><span>utils.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用js严格模式</span></span><br><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="comment">//引入nodejs的path目录路径模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">//引入config文件夹下的配置</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">'../config'</span>)</span><br><span class="line"><span class="comment">//引入ExtractText插件，用于将文本（主要是css）提取到一个单独的文件中去。</span></span><br><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>)</span><br><span class="line"><span class="comment">//引入项目配置package.json</span></span><br><span class="line"><span class="keyword">const</span> packageConfig = <span class="built_in">require</span>(<span class="string">'../package.json'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//此函数用于将一个路径处理为相对于项目根目录的相对路径</span></span><br><span class="line">exports.assetsPath = <span class="function"><span class="keyword">function</span> (<span class="params">_path</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//根据当前环境得到项目的静态资源目录</span></span><br><span class="line">  <span class="keyword">const</span> assetsSubDirectory = process.env.NODE_ENV === <span class="string">'production'</span></span><br><span class="line">    ? config.build.assetsSubDirectory</span><br><span class="line">    : config.dev.assetsSubDirectory</span><br><span class="line">  <span class="comment">//使用path.posix.join得到传入路径相对于资源目录的相对路径</span></span><br><span class="line">  <span class="keyword">return</span> path.posix.join(assetsSubDirectory, _path)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个用于生成cssLoaders配置的cssLoaders函数并导出</span></span><br><span class="line">exports.cssLoaders = <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//若未传入options参数则将其设为一个空对象</span></span><br><span class="line">  options = options || &#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// cssLoader的css配置</span></span><br><span class="line">  <span class="keyword">const</span> cssLoader = &#123;</span><br><span class="line">    loader: <span class="string">'css-loader'</span>,</span><br><span class="line">    options: &#123;</span><br><span class="line">      <span class="comment">//是否开启css的map生成</span></span><br><span class="line">      sourceMap: options.sourceMap</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//cssLoader的postcss配置</span></span><br><span class="line">  <span class="keyword">const</span> postcssLoader = &#123;</span><br><span class="line">    loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">    options: &#123;</span><br><span class="line">      sourceMap: options.sourceMap</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//此函数根据传入的所使用样式的字符串名，如scss，less等生成相应loader配置</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">generateLoaders</span> (<span class="params">loader, loaderOptions</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//loaders配置数组，根据是否使用postCSS来决定是否加入上面定义的postcssLoader的配置</span></span><br><span class="line">    <span class="keyword">const</span> loaders = options.usePostCSS ? [cssLoader, postcssLoader] : [cssLoader]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//根据传入的样式语法名称生成对应的loader配置</span></span><br><span class="line">    <span class="keyword">if</span> (loader) &#123;</span><br><span class="line">      loaders.push(&#123;</span><br><span class="line">        loader: loader + <span class="string">'-loader'</span>,</span><br><span class="line">        options: <span class="built_in">Object</span>.assign(&#123;&#125;, loaderOptions, &#123;</span><br><span class="line">          sourceMap: options.sourceMap</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果函数传入的options参数包含了extract选项定义的话</span></span><br><span class="line">    <span class="comment">// 就配置vue-style-loader使用ExtracTextPlugin插件</span></span><br><span class="line">    <span class="comment">// 将样式提取到一个单独文件中</span></span><br><span class="line">    <span class="keyword">if</span> (options.extract) &#123;</span><br><span class="line">      <span class="keyword">return</span> ExtractTextPlugin.extract(&#123;</span><br><span class="line">        use: loaders,   <span class="comment">//使用对应loader来提取css代码</span></span><br><span class="line">        fallback: <span class="string">'vue-style-loader'</span>  <span class="comment">//如果提取失败就使用此loader提取</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> [<span class="string">'vue-style-loader'</span>].concat(loaders)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 生成各种css的loader配置，作为cssLoders函数的返回值。</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    css: generateLoaders(),</span><br><span class="line">    postcss: generateLoaders(),</span><br><span class="line">    less: generateLoaders(<span class="string">'less'</span>),</span><br><span class="line">    sass: generateLoaders(<span class="string">'sass'</span>, &#123; <span class="attr">indentedSyntax</span>: <span class="literal">true</span> &#125;),</span><br><span class="line">    scss: generateLoaders(<span class="string">'sass'</span>),</span><br><span class="line">    stylus: generateLoaders(<span class="string">'stylus'</span>),</span><br><span class="line">    styl: generateLoaders(<span class="string">'stylus'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成不包含在vue单文件内的样式的loader，例如通过import导入的</span></span><br><span class="line">exports.styleLoaders = <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> output = []</span><br><span class="line">  <span class="comment">//首先使用上面的cssLoaders函数生成的各种loader配置</span></span><br><span class="line">  <span class="keyword">const</span> loaders = exports.cssLoaders(options)</span><br><span class="line">  <span class="comment">//将各种loader加入到一个数组</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> extension <span class="keyword">in</span> loaders) &#123;</span><br><span class="line">    <span class="keyword">const</span> loader = loaders[extension]</span><br><span class="line">    output.push(&#123;</span><br><span class="line">      test: <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'\\.'</span> + extension + <span class="string">'$'</span>),</span><br><span class="line">      use: loader</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//返回包含各种loader配置的数组</span></span><br><span class="line">  <span class="keyword">return</span> output</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//错误通知函数，在发生错误时使用node-notifier来打印出错误信息</span></span><br><span class="line">exports.createNotifierCallback = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> notifier = <span class="built_in">require</span>(<span class="string">'node-notifier'</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">severity, errors</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (severity !== <span class="string">'error'</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> error = errors[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">const</span> filename = error.file &amp;&amp; error.file.split(<span class="string">'!'</span>).pop()</span><br><span class="line"></span><br><span class="line">    notifier.notify(&#123;</span><br><span class="line">      title: packageConfig.name,</span><br><span class="line">      message: severity + <span class="string">': '</span> + error.name,</span><br><span class="line">      subtitle: filename || <span class="string">''</span>,</span><br><span class="line">      icon: path.join(__dirname, <span class="string">'logo.png'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="build-js"><a href="#build-js" class="headerlink" title="build.js"></a><strong><em>build.js</em></strong></h4><p><strong><em>build.js</em></strong> 是我们在执行<code>npm run build</code>时执行的文件，通过相应的<code>webpack</code>配置文件中的配置来构建项目。</p><figure class="highlight js"><figcaption><span>build.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用js严格模式</span></span><br><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="comment">//引入check-versions来检查npm和node版本</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./check-versions'</span>)()</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置当前环境为生产环境</span></span><br><span class="line">process.env.NODE_ENV = <span class="string">'production'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//引入ora插件，此插件用来显示build前的loading动画（就是那个转圈圈的动画</span></span><br><span class="line"><span class="keyword">const</span> ora = <span class="built_in">require</span>(<span class="string">'ora'</span>)</span><br><span class="line"><span class="comment">//引入rimraf插件，此插件用来执行系统的rm -rf 命令</span></span><br><span class="line"><span class="keyword">const</span> rm = <span class="built_in">require</span>(<span class="string">'rimraf'</span>)</span><br><span class="line"><span class="comment">//引入nodejs的PATH模块</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">//引入chalk插件，主要用于为命令行的输出添加颜色</span></span><br><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>)</span><br><span class="line"><span class="comment">//引入webpack</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="comment">//引入config文件下的配置</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">'../config'</span>)</span><br><span class="line"><span class="comment">//引入webpack.prod.conf中的生产环境相关配置</span></span><br><span class="line"><span class="keyword">const</span> webpackConfig = <span class="built_in">require</span>(<span class="string">'./webpack.prod.conf'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//开始loading动画</span></span><br><span class="line"><span class="keyword">const</span> spinner = ora(<span class="string">'building for production...'</span>)</span><br><span class="line">spinner.start()</span><br><span class="line"></span><br><span class="line"><span class="comment">//清空build的目标文件夹，一般默认'./dist'</span></span><br><span class="line">rm(path.join(config.build.assetsRoot, config.build.assetsSubDirectory), err =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">  <span class="comment">//清空文件夹后，执行webpack构建</span></span><br><span class="line">  webpack(webpackConfig, (err, stats) =&gt; &#123;</span><br><span class="line">    spinner.stop()</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">    <span class="comment">//编译完成后，输出编译后的文件详情</span></span><br><span class="line">    process.stdout.write(stats.toString(&#123;</span><br><span class="line">      <span class="comment">//输出控制台信息是否配色</span></span><br><span class="line">      colors: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">//增加内置模块信息的编译选项</span></span><br><span class="line">      modules: <span class="literal">false</span>,</span><br><span class="line">      <span class="comment">// 当项目使用TS时，将此选项置为true，可输出TS编译中错误</span></span><br><span class="line">      children: <span class="literal">false</span>, </span><br><span class="line">      <span class="comment">//允许较少的输出</span></span><br><span class="line">      chunks: <span class="literal">false</span>,</span><br><span class="line">      <span class="comment">//将内置模块信息加到包信息</span></span><br><span class="line">      chunkModules: <span class="literal">false</span></span><br><span class="line">    &#125;) + <span class="string">'\n\n'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//编译过程出错的提示消息</span></span><br><span class="line">    <span class="keyword">if</span> (stats.hasErrors()) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(chalk.red(<span class="string">'  Build failed with errors.\n'</span>))</span><br><span class="line">      process.exit(<span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//编译成功后的输出信息</span></span><br><span class="line">    <span class="built_in">console</span>.log(chalk.cyan(<span class="string">'  Build complete.\n'</span>))</span><br><span class="line">    <span class="built_in">console</span>.log(chalk.yellow(</span><br><span class="line">      <span class="string">'  Tip: built files are meant to be served over an HTTP server.\n'</span> +</span><br><span class="line">      <span class="string">'  Opening index.html over file:// won\'t work.\n'</span></span><br><span class="line">    ))</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="check-versions-js"><a href="#check-versions-js" class="headerlink" title="check-versions.js"></a><strong><em>check-versions.js</em></strong></h4><p><strong><em>bulid</em></strong> 文件夹下的<strong><em>check-versions.js</em></strong>文件，它与其他文件没什么关联，作用比较简单——用来检测<code>node</code>和<code>npm</code>版本。</p><p>具体实现代码如下，我做了详细注释。</p><figure class="highlight js"><figcaption><span>check-versions.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用js的严格模式</span></span><br><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="comment">//引入插件chalk，此插件用于为文字添加不同的颜色从而便于在命令行输出。</span></span><br><span class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>)</span><br><span class="line"><span class="comment">//引入插件semver，用于将版本号转换为纯净的数字形式。例如将v9.10.1转换为9.10.1</span></span><br><span class="line"><span class="keyword">const</span> semver = <span class="built_in">require</span>(<span class="string">'semver'</span>)</span><br><span class="line"><span class="comment">//导入项目的配置文件package.json,主要为了使用其中的engines声明的node和npm版本选项</span></span><br><span class="line"><span class="keyword">const</span> packageConfig = <span class="built_in">require</span>(<span class="string">'../package.json'</span>)</span><br><span class="line"><span class="comment">//引入插件shelljs,此插件用于执行Unix命令，我们通过此插件来确定npm是否安装</span></span><br><span class="line"><span class="keyword">const</span> shell = <span class="built_in">require</span>(<span class="string">'shelljs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//exec函数用于执行命令行命令</span></span><br><span class="line"><span class="comment">//它接受一个cmd命令，并通过引入child_process插件新建一个子进程来执行cmd命令，将命令结果转化为前后没有空格的字符串。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">exec</span> (<span class="params">cmd</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">'child_process'</span>).execSync(cmd).toString().trim()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//node的版本信息</span></span><br><span class="line"><span class="keyword">const</span> versionRequirements = [</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">'node'</span>, </span><br><span class="line">    <span class="comment">//当前的node版本，通过process.version获得</span></span><br><span class="line">    currentVersion: semver.clean(process.version),</span><br><span class="line">    <span class="comment">//项目依赖的node版本，从项目配置文件中获得</span></span><br><span class="line">    versionRequirement: packageConfig.engines.node</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">//npm的版本信息</span></span><br><span class="line"><span class="keyword">if</span> (shell.which(<span class="string">'npm'</span>)) &#123;</span><br><span class="line">  versionRequirements.push(&#123;</span><br><span class="line">    name: <span class="string">'npm'</span>,</span><br><span class="line">    <span class="comment">//当前的npm版本，通过上面的exec执行命令npm --version 获得</span></span><br><span class="line">    currentVersion: exec(<span class="string">'npm --version'</span>),</span><br><span class="line">    <span class="comment">//项目依赖的npm版本</span></span><br><span class="line">    versionRequirement: packageConfig.engines.npm</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//根据上面的node和npm版本信息，进行相应提示和操作。</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> warnings = []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; versionRequirements.length; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> mod = versionRequirements[i]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//如果当前的版本不满足项目依赖的要求，将相应信息加入到警告信息列表</span></span><br><span class="line">    <span class="keyword">if</span> (!semver.satisfies(mod.currentVersion, mod.versionRequirement)) &#123;</span><br><span class="line">      warnings.push(mod.name + <span class="string">': '</span> +</span><br><span class="line">        chalk.red(mod.currentVersion) + <span class="string">' should be '</span> +</span><br><span class="line">        chalk.green(mod.versionRequirement)</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//如果警告信息列表不为空，向命令行输出警告信息</span></span><br><span class="line">  <span class="keyword">if</span> (warnings.length) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">''</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(chalk.yellow(<span class="string">'To use this template, you must update following to modules:'</span>))</span><br><span class="line">    <span class="built_in">console</span>.log()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; warnings.length; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> warning = warnings[i]</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'  '</span> + warning)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log()</span><br><span class="line">    <span class="comment">//结束进程</span></span><br><span class="line">    process.exit(<span class="number">1</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a><strong><em>package.json</em></strong></h3><p>我们顺便来讲解一下项目的<strong><em>package.json</em></strong>，作为项目的配置文件，它主要用来保存项目的基本信息和管理项目的相关依赖。</p><p>我们执行<code>npm install</code>时，就是通过它里面的项目依赖列表来确定安装那些包的。</p><figure class="highlight js"><figcaption><span>package.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">//从name到private，是项目的基本信息和配置。在新建项目时询问我们的就是这些信息</span></span><br><span class="line">  <span class="comment">//项目名称，不能包含大写字母和点和下划线</span></span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"my-vue"</span>,</span><br><span class="line">  <span class="comment">//项目版本</span></span><br><span class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="comment">//项目描述</span></span><br><span class="line">  <span class="string">"description"</span>: <span class="string">"A Vue.js project"</span>,</span><br><span class="line">  <span class="comment">//项目作者</span></span><br><span class="line">  <span class="string">"author"</span>: <span class="string">"Gyf_linux &lt;guo812773673@163.com&gt;"</span>,</span><br><span class="line">  <span class="comment">//项目是否私有</span></span><br><span class="line">  <span class="string">"private"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">//scripts命令，也就是我们通过控制台执行的缩写命令对应的命令行命令</span></span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="comment">//启动本地http服务器，能够实时相应文件改变</span></span><br><span class="line">    <span class="comment">//inline模式是指我们直接访问的就是项目根目录的index.html，对应有另一个模式iframe</span></span><br><span class="line">    <span class="comment">//progess 为显示打包进度</span></span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --inline --progress --config build/webpack.dev.conf.js"</span>,</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"npm run dev"</span>,</span><br><span class="line">    <span class="string">"lint"</span>: <span class="string">"eslint --ext .js,.vue src"</span>,</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"node build/build.js"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//项目的依赖，安装模块使用--save指令选项即是把模块置于此中</span></span><br><span class="line">  <span class="string">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"vue"</span>: <span class="string">"^2.5.2"</span>,</span><br><span class="line">    <span class="string">"vue-router"</span>: <span class="string">"^3.0.1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//开发环境的依赖，安装模块时使用--save-dev将模块置于此中</span></span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="comment">//用于为css添加浏览器前缀</span></span><br><span class="line">    <span class="string">"autoprefixer"</span>: <span class="string">"^7.1.2"</span>,</span><br><span class="line">    <span class="comment">//以下以babel开头的均为针对es6解析的插件</span></span><br><span class="line">    <span class="string">"babel-core"</span>: <span class="string">"^6.22.1"</span>,</span><br><span class="line">    <span class="string">"babel-eslint"</span>: <span class="string">"^8.2.1"</span>,</span><br><span class="line">    <span class="string">"babel-helper-vue-jsx-merge-props"</span>: <span class="string">"^2.0.3"</span>,</span><br><span class="line">    <span class="string">"babel-loader"</span>: <span class="string">"^7.1.1"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-syntax-jsx"</span>: <span class="string">"^6.18.0"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-transform-runtime"</span>: <span class="string">"^6.22.0"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-transform-vue-jsx"</span>: <span class="string">"^3.5.0"</span>,</span><br><span class="line">    <span class="string">"babel-preset-env"</span>: <span class="string">"^1.3.2"</span>,</span><br><span class="line">    <span class="string">"babel-preset-stage-2"</span>: <span class="string">"^6.22.0"</span>,</span><br><span class="line">    <span class="comment">//用于为命令行输出配色</span></span><br><span class="line">    <span class="string">"chalk"</span>: <span class="string">"^2.0.1"</span>,</span><br><span class="line">    <span class="comment">//用于拷贝文件到其他目录</span></span><br><span class="line">    <span class="string">"copy-webpack-plugin"</span>: <span class="string">"^4.0.1"</span>,</span><br><span class="line">    <span class="comment">//用于解析css格式的文件</span></span><br><span class="line">    <span class="string">"css-loader"</span>: <span class="string">"^0.28.0"</span>,</span><br><span class="line">    <span class="comment">//以下以eslint开头的就用于eslint语法检查</span></span><br><span class="line">    <span class="string">"eslint"</span>: <span class="string">"^4.15.0"</span>,</span><br><span class="line">    <span class="string">"eslint-config-standard"</span>: <span class="string">"^10.2.1"</span>,</span><br><span class="line">    <span class="string">"eslint-friendly-formatter"</span>: <span class="string">"^3.0.0"</span>,</span><br><span class="line">    <span class="string">"eslint-loader"</span>: <span class="string">"^1.7.1"</span>,</span><br><span class="line">    <span class="string">"eslint-plugin-import"</span>: <span class="string">"^2.7.0"</span>,</span><br><span class="line">    <span class="string">"eslint-plugin-node"</span>: <span class="string">"^5.2.0"</span>,</span><br><span class="line">    <span class="string">"eslint-plugin-promise"</span>: <span class="string">"^3.4.0"</span>,</span><br><span class="line">    <span class="string">"eslint-plugin-standard"</span>: <span class="string">"^3.0.1"</span>,</span><br><span class="line">    <span class="string">"eslint-plugin-vue"</span>: <span class="string">"^4.0.0"</span>,</span><br><span class="line">    <span class="comment">//用于将文本提取到单独的文件中去，主要用于提取css</span></span><br><span class="line">    <span class="string">"extract-text-webpack-plugin"</span>: <span class="string">"^3.0.0"</span>,</span><br><span class="line">    <span class="comment">//用于压缩文件</span></span><br><span class="line">    <span class="string">"file-loader"</span>: <span class="string">"^1.1.4"</span>,</span><br><span class="line">    <span class="comment">//整理和聚合webpack错误，并以更友好的形式输出</span></span><br><span class="line">    <span class="string">"friendly-errors-webpack-plugin"</span>: <span class="string">"^1.6.1"</span>,</span><br><span class="line">    <span class="comment">//根据模板创建html文件并将资源引入到此文件</span></span><br><span class="line">    <span class="string">"html-webpack-plugin"</span>: <span class="string">"^2.30.1"</span>,</span><br><span class="line">    <span class="comment">//使用node发送跨平台的通知</span></span><br><span class="line">    <span class="string">"node-notifier"</span>: <span class="string">"^5.1.2"</span>,</span><br><span class="line">    <span class="comment">//压缩css文件，并解决使用ExtractTextPlugin插件提取出的css中的重复</span></span><br><span class="line">    <span class="string">"optimize-css-assets-webpack-plugin"</span>: <span class="string">"^3.2.0"</span>,</span><br><span class="line">    <span class="comment">//用于在命令显示动画的插件</span></span><br><span class="line">    <span class="string">"ora"</span>: <span class="string">"^1.2.0"</span>,</span><br><span class="line">    <span class="comment">//查看进程端口</span></span><br><span class="line">    <span class="string">"portfinder"</span>: <span class="string">"^1.0.13"</span>,</span><br><span class="line">    <span class="comment">//postcss用于处理postcss相关的样式</span></span><br><span class="line">    <span class="string">"postcss-import"</span>: <span class="string">"^11.0.0"</span>,</span><br><span class="line">    <span class="string">"postcss-loader"</span>: <span class="string">"^2.0.8"</span>,</span><br><span class="line">    <span class="string">"postcss-url"</span>: <span class="string">"^7.2.1"</span>,</span><br><span class="line">    <span class="comment">//执行命令行rm -rf 命令</span></span><br><span class="line">    <span class="string">"rimraf"</span>: <span class="string">"^2.6.0"</span>,</span><br><span class="line">    <span class="comment">//对库版本号进行格式化和比较</span></span><br><span class="line">    <span class="string">"semver"</span>: <span class="string">"^5.3.0"</span>,</span><br><span class="line">    <span class="comment">//用于执行shell命令</span></span><br><span class="line">    <span class="string">"shelljs"</span>: <span class="string">"^0.7.6"</span>,</span><br><span class="line">    <span class="comment">//用于压缩js</span></span><br><span class="line">    <span class="string">"uglifyjs-webpack-plugin"</span>: <span class="string">"^1.1.1"</span>,</span><br><span class="line">    <span class="comment">//用于将图片转换为base64的DataUrl</span></span><br><span class="line">    <span class="string">"url-loader"</span>: <span class="string">"^0.5.8"</span>,</span><br><span class="line">    <span class="comment">//vue单文件组件的核心webpack加载器</span></span><br><span class="line">    <span class="string">"vue-loader"</span>: <span class="string">"^13.3.0"</span>,</span><br><span class="line">    <span class="comment">//用于vue单文件中的css处理，将经过各loader处理后的css作为style标签引入根文件中。</span></span><br><span class="line">    <span class="string">"vue-style-loader"</span>: <span class="string">"^3.0.1"</span>,</span><br><span class="line">    <span class="comment">//用于vue单文件的模板编译</span></span><br><span class="line">    <span class="string">"vue-template-compiler"</span>: <span class="string">"^2.5.2"</span>,</span><br><span class="line">    <span class="comment">//打包工具webpack</span></span><br><span class="line">    <span class="string">"webpack"</span>: <span class="string">"^3.6.0"</span>,</span><br><span class="line">    <span class="comment">//用于可视化分析webpack打包后的项目各文件大小</span></span><br><span class="line">    <span class="string">"webpack-bundle-analyzer"</span>: <span class="string">"^2.9.0"</span>,</span><br><span class="line">    <span class="comment">//实时重载的本地开发服务器</span></span><br><span class="line">    <span class="string">"webpack-dev-server"</span>: <span class="string">"^2.9.1"</span>,</span><br><span class="line">    <span class="comment">//用于配置对象的合并，重复的选项将会被覆盖。</span></span><br><span class="line">    <span class="string">"webpack-merge"</span>: <span class="string">"^4.1.0"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//项目需要的node和npm的版本</span></span><br><span class="line">  <span class="string">"engines"</span>: &#123;</span><br><span class="line">    <span class="string">"node"</span>: <span class="string">"&gt;= 6.0.0"</span>,</span><br><span class="line">    <span class="string">"npm"</span>: <span class="string">"&gt;= 3.0.0"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//项目需要的浏览器或客户端版本</span></span><br><span class="line">  <span class="string">"browserslist"</span>: [</span><br><span class="line">    <span class="string">"&gt; 1%"</span>,</span><br><span class="line">    <span class="string">"last 2 versions"</span>,</span><br><span class="line">    <span class="string">"not ie &lt;= 8"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>通过上面的介绍和总结，我们对<code>vue</code>的脚手架结构和其中各文件的作用应该有了一定的了解和认识。由于篇幅有限，对其中具体的一些插件的配置项和使用并未做详细解释。当然，在需要用到时，这些插件的文档，去搜索一下也很容易找到。</p><p>写这篇文章，我去查了很多文档和博客，一行行的注释写下来，腰酸背痛。也愈发佩服<code>vue</code>的作者了，能把这些琐碎的配置，组织的文件结构明了，代码逻辑清晰，写法简洁优雅，实在是厉害。哎，前方路远，差距好大，努力努力。</p><p>好啦，感谢阅读本文^_^。我赶紧去休息一下去。</p></div><div></div><div><div style="text-align:center;color:#ccc;font-size:14px">----本文结束<i class="fa fa-star-o" style="color:#c40000"></i>感谢阅读----</div></div><div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/前端/" rel="tag"><i class="fa fa-tag"></i> 前端</a> <a href="/tags/Vue/" rel="tag"><i class="fa fa-tag"></i> Vue</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2018/05/04/css-two-col-fix/" rel="next" title="CSS两栏布局的常用方法"><i class="fa fa-chevron-left"></i> CSS两栏布局的常用方法</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2018/05/12/es6-Generator/" rel="prev" title="ES6之Generator">ES6之Generator <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Gyf"><p class="site-author-name" itemprop="name">Gyf</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">85</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">19</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">33</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Gyufei" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="http://www.zhihu.com/people/afei-7701" target="_blank" title="知乎"><i class="fa fa-fw fa-globe"></i> 知乎 </a></span><span class="links-of-author-item"><a href="http://weibo.com/1865042755/profile" target="_blank" title="微博"><i class="fa fa-fw fa-weibo"></i> 微博</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#目录结构"><span class="nav-number">1.</span> <span class="nav-text">目录结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#config文件夹"><span class="nav-number">2.</span> <span class="nav-text">config文件夹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#index-js"><span class="nav-number">2.1.</span> <span class="nav-text">index.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#prod-env-js"><span class="nav-number">2.2.</span> <span class="nav-text">prod.env.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dev-env-js"><span class="nav-number">2.3.</span> <span class="nav-text">dev.env.js</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#build-文件夹"><span class="nav-number">3.</span> <span class="nav-text">build 文件夹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack-base-conf-js"><span class="nav-number">3.1.</span> <span class="nav-text">webpack.base.conf.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack-prod-conf-js"><span class="nav-number">3.2.</span> <span class="nav-text">webpack.prod.conf.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webpack-dev-conf-js"><span class="nav-number">3.3.</span> <span class="nav-text">webpack.dev.conf.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#vue-loader-conf-js"><span class="nav-number">3.4.</span> <span class="nav-text">vue-loader.conf.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#utils-js"><span class="nav-number">3.5.</span> <span class="nav-text">utils.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#build-js"><span class="nav-number">3.6.</span> <span class="nav-text">build.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#check-versions-js"><span class="nav-number">3.7.</span> <span class="nav-text">check-versions.js</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#package-json"><span class="nav-number">4.</span> <span class="nav-text">package.json</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#总结"><span class="nav-number">5.</span> <span class="nav-text">总结</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2019</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Gyf</span></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.min.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.ui.min.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript">var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: true,
        notify: true,
        appId: 'R8P4WPUO7InstdDE6XwcqVrX-gzGzoHsz',
        appKey: 'iQ1KQlQNe09VHxuX34voY8FV',
        placeholder: '请随便说点什么吧^_^',
        avatar:'monsterid',
        guest_info:guest,
        pageSize:'10' || 10,
    });</script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".popup").toggle()}var isfetched=!1,search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path,searchFunc=function(e,t,a){"use strict";$.ajax({url:e,dataType:"xml",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var r=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),c=document.getElementById(t),s=document.getElementById(a);c.addEventListener("input",function(){var e=0,t='<ul class="search-result-list">',a=this.value.trim().toLowerCase().split(/[\s\-]+/);s.innerHTML="",this.value.trim().length>1&&r.forEach(function(r){var c=!1,s=r.title.trim().toLowerCase(),o=r.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),n=decodeURIComponent(r.url),i=-1,l=-1,p=-1;if(""!=s&&a.forEach(function(e,t){i=s.indexOf(e),l=o.indexOf(e),(i>=0||l>=0)&&(c=!0,0==t&&(p=l))}),c){e+=1,t+="<li><a href='"+n+"' class='search-result-title'>"+s+"</a>";var h=r.content.trim().replace(/<[^>]+>/g,"");if(p>=0){var u=p-20,d=p+80;0>u&&(u=0),0==u&&(d=50),d>h.length&&(d=h.length);var f=h.substring(u,d);a.forEach(function(e){var t=new RegExp(e,"gi");f=f.replace(t,'<b class="search-keyword">'+e+"</b>")}),t+='<p class="search-result">'+f+"...</p>"}t+="</li>"}}),t+="</ul>",0==e&&(t='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'),""==a&&(t='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'),s.innerHTML=t}),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),0==isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(function(e){$(".popup").hide(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")}),$(".popup").click(function(e){e.stopPropagation()})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></body><script>$(document).ready(function(){var e=function(e){var o,n,t=document,i=e;t.body.createTextRange?(o=document.body.createTextRange(),o.moveToElementText(i),o.select()):window.getSelection&&(n=window.getSelection(),o=document.createRange(),o.selectNodeContents(i),n.removeAllRanges(),n.addRange(o))};$(".code").each(function(){var o=$(this).get(0),n="<div style=\"position: fixed;right: 3%;margin-top: 5px;font-family: consolas, Menlo, 'PingFang SC', 'Microsoft YaHei', monospace;font-size: 10px;cursor: pointer;color: #e31436;\"><span><i class=\"fa fa-copy fa-lg\"></i></span></div>",t=$(n);$(t).click(function(){e(o)}),$(t).insertBefore(this)})})</script></html><!-- rebuild by neat -->